# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–æ—Ñ–∏–ª—è

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å –Ω–∞ backend:
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∏–º–µ–Ω–∏, —Ñ–∞–º–∏–ª–∏–∏, email –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–æ
- –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è –Ω–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–ª–∞
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (—Ç–µ–º–∞, —Ü–≤–µ—Ç–∞, —à—Ä–∏—Ñ—Ç) –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º—É–∑—ã–∫–∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å
- –ó–∞–≥—Ä—É–∑–∫–∞ –∞–≤–∞—Ç–∞—Ä–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∞

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. Backend - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ settings

```sql
ALTER TABLE users ADD COLUMN settings TEXT;
```

–¢–µ–ø–µ—Ä—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏ –º—É–∑—ã–∫–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ.

### 2. Backend - –û–±–Ω–æ–≤–ª–µ–Ω —Ä–æ—É—Ç –ø—Ä–æ—Ñ–∏–ª—è

**–§–∞–π–ª:** `server/routes/users.js`

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ JSON
- –í–∞–ª–∏–¥–∞—Ü–∏—è username –∏ email –Ω–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å
- –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ç–µ–∫—É—â–µ–≥–æ
- –í–æ–∑–≤—Ä–∞—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è
- WebSocket broadcast –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è

**API:**
```javascript
PUT /api/users/profile
Body: {
  firstName, lastName, username, email, avatar,
  currentPassword, newPassword,
  settings: {
    theme, colorScheme, fontSize, animations,
    musicEnabled, playlist, volume, soundsEnabled
  }
}
```

### 3. Frontend - –ü–æ–ª–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

**–§–∞–π–ª:** `client/src/components/EnhancedProfileSettings.tsx`

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**

#### –ó–∞–≥—Ä—É–∑–∫–∞ –∞–≤–∞—Ç–∞—Ä–∞:
```typescript
const handleAvatarChange = async (e) => {
  const file = e.target.files?.[0];
  const reader = new FileReader();
  reader.onload = () => setAvatar(reader.result as string);
  reader.readAsDataURL(file);
};
```

#### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫:
```typescript
const handleSave = async () => {
  const response = await fetch('/api/users/profile', {
    method: 'PUT',
    body: JSON.stringify({
      firstName, lastName, username, email, avatar,
      currentPassword, newPassword,
      settings: { theme, colorScheme, fontSize, ... }
    })
  });
  
  const updatedUser = await response.json();
  useAuthStore.setState({ user: updatedUser });
};
```

#### –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫:
```typescript
useEffect(() => {
  if (user?.settings) {
    const s = JSON.parse(user.settings);
    setTheme(s.theme || 'auto');
    setColorScheme(s.colorScheme || 'blue');
    // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
  }
}, [user]);
```

## üéØ –ß—Ç–æ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç

### ‚úÖ –õ–∏—á–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –∏ —Ñ–∞–º–∏–ª–∏–∏
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ username (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏)
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ email (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏)
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∞–≤–∞—Ç–∞—Ä–∞ (base64)
- ‚úÖ –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ç–µ–∫—É—â–µ–≥–æ)
- ‚úÖ –ü–æ–ª–µ "–û —Å–µ–±–µ" (bio)

### ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:
- ‚úÖ –¢–µ–º–∞: –°–≤–µ—Ç–ª–∞—è / –¢–µ–º–Ω–∞—è / –ê–≤—Ç–æ
- ‚úÖ –¶–≤–µ—Ç–æ–≤–∞—è –ø–∞–ª–∏—Ç—Ä–∞: 5 —Ü–≤–µ—Ç–æ–≤
- ‚úÖ –†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞: 12-20px
- ‚úÖ –ê–Ω–∏–º–∞—Ü–∏–∏: –í–∫–ª/–í—ã–∫–ª

### ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º—É–∑—ã–∫–∏:
- ‚úÖ –§–æ–Ω–æ–≤–∞—è –º—É–∑—ã–∫–∞: –í–∫–ª/–í—ã–∫–ª
- ‚úÖ –ü–ª–µ–π–ª–∏—Å—Ç: Lofi / Ambient / Classical / Jazz
- ‚úÖ –ì—Ä–æ–º–∫–æ—Å—Ç—å: 0-100%
- ‚úÖ –ó–≤—É–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π: –í–∫–ª/–í—ã–∫–ª –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞

## üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

### Backend ‚Üí Frontend:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
2. –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ `user.settings`
3. –í—Å–µ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### Frontend ‚Üí Backend:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–∑–º–µ–Ω—è–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
2. –ù–∞–∂–∏–º–∞–µ—Ç "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è"
3. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è PUT –∑–∞–ø—Ä–æ—Å —Å –≤—Å–µ–º–∏ –¥–∞–Ω–Ω—ã–º–∏
4. Backend —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –ë–î
5. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
6. Frontend –æ–±–Ω–æ–≤–ª—è–µ—Ç store

### Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:
```javascript
io.emit('user:profile_updated', {
  userId, username, firstName, lastName, avatar
});
```

–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

## üìã –í–∞–ª–∏–¥–∞—Ü–∏—è

### Backend:
- ‚úÖ –ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã
- ‚úÖ Username –º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞
- ‚úÖ Username —É–Ω–∏–∫–∞–ª–µ–Ω
- ‚úÖ Email —É–Ω–∏–∫–∞–ª–µ–Ω
- ‚úÖ –ü–∞—Ä–æ–ª—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –ø–∞—Ä–æ–ª—è –ø—Ä–∏ —Å–º–µ–Ω–µ

### Frontend:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—à–∏–±–æ–∫
- ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
- ‚úÖ –£—Å–ø–µ—à–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

## üé® UX —É–ª—É—á—à–µ–Ω–∏—è

### –ò–Ω–¥–∏–∫–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è:
```typescript
{saving ? '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...' : '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è'}
```

### –°–æ–æ–±—â–µ–Ω–∏—è:
```typescript
{message && (
  <div className={message.includes('‚úÖ') ? 'success' : 'error'}>
    {message}
  </div>
)}
```

### –ê–≤—Ç–æ–∑–∞–∫—Ä—ã—Ç–∏–µ:
```typescript
setTimeout(() => onClose(), 1500); // –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. ‚úÖ –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è
2. ‚úÖ –ò–∑–º–µ–Ω–∏—Ç–µ –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—é ‚Üí –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ
3. ‚úÖ –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∞–≤–∞—Ç–∞—Ä ‚Üí –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ
4. ‚úÖ –ò–∑–º–µ–Ω–∏—Ç–µ —Ç–µ–º—É ‚Üí –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ ‚Üí –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É
5. ‚úÖ –ò–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å ‚Üí –í—ã–π–¥–∏—Ç–µ ‚Üí –í–æ–π–¥–∏—Ç–µ —Å –Ω–æ–≤—ã–º –ø–∞—Ä–æ–ª–µ–º
6. ‚úÖ –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º—É–∑—ã–∫–∏ ‚Üí –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ
7. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏—Å—å –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### User object:
```typescript
{
  id: string,
  email: string,
  username: string,
  firstName: string,
  lastName: string,
  avatar: string,
  role: string,
  settings: {
    theme: 'light' | 'dark' | 'auto',
    colorScheme: string,
    fontSize: number,
    animations: boolean,
    musicEnabled: boolean,
    playlist: string,
    volume: number,
    soundsEnabled: boolean
  }
}
```

## üöÄ –ó–∞–ø—É—Å–∫

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä –∏ –∫–ª–∏–µ–Ω—Ç
npm run dev
```

–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã! üéâ
