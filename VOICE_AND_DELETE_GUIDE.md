# üé§ –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏–µ —á–∞—Ç–æ–≤

## ‚úÖ –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

### 1. üéôÔ∏è Telegram-—Å—Ç–∏–ª—å –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

**TelegramVoiceRecorder.tsx** - –ø–æ–ª–Ω–∞—è –∫–æ–ø–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ Telegram:

#### –§—É–Ω–∫—Ü–∏–∏:
- ‚úÖ **–£–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ –¥–ª—è –∑–∞–ø–∏—Å–∏** - –∑–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
- ‚úÖ **–°–¥–≤–∏–Ω—å—Ç–µ –≤–ª–µ–≤–æ –¥–ª—è –æ—Ç–º–µ–Ω—ã** - –æ—Ç–º–µ–Ω—è–µ—Ç –∑–∞–ø–∏—Å—å
- ‚úÖ **–°–¥–≤–∏–Ω—å—Ç–µ –≤–≤–µ—Ä—Ö –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏** - —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç –∑–∞–ø–∏—Å—å
- ‚úÖ **–û—Ç–ø—É—Å—Ç–∏—Ç–µ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞
- ‚úÖ **–¢–∞–π–º–µ—Ä –∑–∞–ø–∏—Å–∏** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ **–ê–Ω–∏–º–∞—Ü–∏—è –ø—É–ª—å—Å–∞—Ü–∏–∏** - –∫—Ä–∞—Å–Ω—ã–π –∫—Ä—É–≥ —Å –º–∏–∫—Ä–æ—Ñ–æ–Ω–æ–º
- ‚úÖ **–ò–∫–æ–Ω–∫–∞ –∑–∞–º–∫–∞** - –ø—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ –∑–∞–ø–∏—Å–∏
- ‚úÖ **–ö–Ω–æ–ø–∫–∏ –æ—Ç–º–µ–Ω—ã/–æ—Ç–ø—Ä–∞–≤–∫–∏** - –≤ —Ä–µ–∂–∏–º–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

#### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:
```typescript
// 1. –ó–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É - –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å—å
onMouseDown / onTouchStart

// 2. –î–≤–∏–≥–∞–π—Ç–µ –ø–∞–ª–µ—Ü:
// - –í–ª–µ–≤–æ > 150px = –æ—Ç–º–µ–Ω–∞
// - –í–≤–µ—Ä—Ö > 100px = –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞

// 3. –û—Ç–ø—É—Å—Ç–∏—Ç–µ:
// - –ï—Å–ª–∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ - –æ—Å—Ç–∞–µ—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç—ã–º
// - –ï—Å–ª–∏ –Ω–µ—Ç - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

### 2. üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ —á–∞—Ç–æ–≤

**Backend:** `DELETE /api/chats/:chatId`
- –¢–æ–ª—å–∫–æ ADMIN –º–æ–∂–µ—Ç —É–¥–∞–ª—è—Ç—å
- –£–¥–∞–ª—è–µ—Ç –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- –£–¥–∞–ª—è–µ—Ç –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- –£–¥–∞–ª—è–µ—Ç —Å–∞–º —á–∞—Ç

**Frontend:** –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –≤ —Å–ø–∏—Å–∫–µ —á–∞—Ç–æ–≤
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è ADMIN
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞

### 3. üì± EnhancedChatPage

–ù–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –ø–æ–ª–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º:
- ‚úÖ –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ –≤ sidebar
- ‚úÖ –ö–Ω–æ–ø–∫–∞ –∏–Ω–≤–∞–π—Ç–æ–≤
- ‚úÖ –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —á–∞—Ç–∞ (–¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
- ‚úÖ –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Å—Ç–∏–ª–µ Telegram
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–æ–≤ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π —Å audio player

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ EnhancedChatPage

```bash
# –í –±—Ä–∞—É–∑–µ—Ä–µ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞:
http://localhost:5173/enhanced
```

### –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

1. **–ë—ã—Å—Ç—Ä–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞:**
   - –ó–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
   - –ì–æ–≤–æ—Ä–∏—Ç–µ
   - –û—Ç–ø—É—Å—Ç–∏—Ç–µ - —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—Å—è

2. **–î–ª–∏–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å:**
   - –ó–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É
   - –°–¥–≤–∏–Ω—å—Ç–µ –≤–≤–µ—Ä—Ö –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
   - –ì–æ–≤–æ—Ä–∏—Ç–µ —Å–∫–æ–ª—å–∫–æ –Ω—É–∂–Ω–æ
   - –ù–∞–∂–º–∏—Ç–µ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å"

3. **–û—Ç–º–µ–Ω–∞:**
   - –°–¥–≤–∏–Ω—å—Ç–µ –≤–ª–µ–≤–æ > 150px
   - –ò–ª–∏ –Ω–∞–∂–º–∏—Ç–µ "–û—Ç–º–µ–Ω–∏—Ç—å" –≤ —Ä–µ–∂–∏–º–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

### –£–¥–∞–ª–µ–Ω–∏–µ —á–∞—Ç–∞

```typescript
// –¢–æ–ª—å–∫–æ –¥–ª—è ADMIN
const handleDeleteChat = async (chatId: string) => {
  if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —á–∞—Ç?')) {
    await chatsApiExtended.deleteChat(chatId);
    await loadChats(); // –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫
  }
};
```

## üé® UI/UX –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### TelegramVoiceRecorder

**–í–∏–∑—É–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã:**
- –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π overlay —Å –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ–º
- –ë–æ–ª—å—à–æ–π –∫—Ä–∞—Å–Ω—ã–π –∫—Ä—É–≥ —Å –º–∏–∫—Ä–æ—Ñ–æ–Ω–æ–º
- –ê–Ω–∏–º–∞—Ü–∏—è –ø—É–ª—å—Å–∞—Ü–∏–∏
- –¢–∞–π–º–µ—Ä –≤ —Ñ–æ—Ä–º–∞—Ç–µ MM:SS
- –ü–æ–¥—Å–∫–∞–∑–∫–∏ –¥–ª—è –∂–µ—Å—Ç–æ–≤
- –ò–∫–æ–Ω–∫–∞ –∑–∞–º–∫–∞ –ø—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ

**–ê–Ω–∏–º–∞—Ü–∏–∏:**
- –ü–ª–∞–≤–Ω–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ/–∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏–µ
- –ü—É–ª—å—Å–∞—Ü–∏—è –∫—Ä–∞—Å–Ω–æ–≥–æ –∫—Ä—É–≥–∞
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏ –ø–æ–¥—Å–∫–∞–∑–æ–∫
- Smooth transitions

**–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å:**
- –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ desktop (–º—ã—à—å)
- –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ mobile (touch)
- Responsive –¥–∏–∑–∞–π–Ω
- Dark mode –ø–æ–¥–¥–µ—Ä–∂–∫–∞

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```
EnhancedChatPage
‚îú‚îÄ‚îÄ Sidebar
‚îÇ   ‚îú‚îÄ‚îÄ –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ –ö–Ω–æ–ø–∫–∞ –∏–Ω–≤–∞–π—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è (–¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
‚îú‚îÄ‚îÄ Chat Area
‚îÇ   ‚îú‚îÄ‚îÄ Header
‚îÇ   ‚îú‚îÄ‚îÄ Messages
‚îÇ   ‚îî‚îÄ‚îÄ Input
‚îÇ       ‚îú‚îÄ‚îÄ –ö–Ω–æ–ø–∫–∞ —Ñ–∞–π–ª–æ–≤
‚îÇ       ‚îú‚îÄ‚îÄ –¢–µ–∫—Å—Ç–æ–≤—ã–π input
‚îÇ       ‚îî‚îÄ‚îÄ –ö–Ω–æ–ø–∫–∞ –≥–æ–ª–æ—Å–∞ (–µ—Å–ª–∏ –ø—É—Å—Ç–æ)
‚îú‚îÄ‚îÄ TelegramVoiceRecorder (modal)
‚îî‚îÄ‚îÄ InviteManager (modal)
```

## üîß API Endpoints

### –£–¥–∞–ª–µ–Ω–∏–µ —á–∞—Ç–∞
```http
DELETE /api/chats/:chatId
Authorization: Bearer {token}

Response:
{
  "message": "–ß–∞—Ç —É–¥–∞–ª–µ–Ω"
}
```

### –û—Ç–ø—Ä–∞–≤–∫–∞ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
```http
POST /api/messages
Content-Type: application/json
Authorization: Bearer {token}

Body:
{
  "chatId": "chat-id",
  "content": "data:audio/webm;base64,...",
  "type": "VOICE"
}
```

## üí° –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TelegramVoiceRecorder

```tsx
import { TelegramVoiceRecorder } from '../components/TelegramVoiceRecorder';

const [showVoice, setShowVoice] = useState(false);

// –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∫–æ—Ä–¥–µ—Ä
<button onClick={() => setShowVoice(true)}>
  –ó–∞–ø–∏—Å–∞—Ç—å –≥–æ–ª–æ—Å
</button>

// –ö–æ–º–ø–æ–Ω–µ–Ω—Ç
{showVoice && (
  <TelegramVoiceRecorder
    onSend={async (blob, duration) => {
      const base64 = await fileUtils.convertToBase64(
        new File([blob], 'voice.webm')
      );
      // –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
      sendMessage({ content: base64, type: 'VOICE' });
      setShowVoice(false);
    }}
    onCancel={() => setShowVoice(false)}
  />
)}
```

### –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è

```tsx
{message.type === 'VOICE' ? (
  <audio controls src={message.content} className="max-w-xs" />
) : (
  <p>{message.content}</p>
)}
```

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### Telegram-—Å—Ç–∏–ª—å
- ‚úÖ –ü—Ä–∏–≤—ã—á–Ω—ã–π UX –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ –£–¥–æ–±–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö
- ‚úÖ –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–∞—è –æ—Ç–º–µ–Ω–∞ –∂–µ—Å—Ç–æ–º

### –£–¥–∞–ª–µ–Ω–∏–µ —á–∞—Ç–æ–≤
- ‚úÖ –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ó–∞—â–∏—Ç–∞ –ø—Ä–∞–≤ (—Ç–æ–ª—å–∫–æ ADMIN)
- ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
- ‚úÖ –ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ

## üì± –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ `/enhanced`
2. –°–æ–∑–¥–∞–π—Ç–µ —á–∞—Ç
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≥–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è:
   - –ë—ã—Å—Ç—Ä–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞
   - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∑–∞–ø–∏—Å–∏
   - –û—Ç–º–µ–Ω–∞ –∂–µ—Å—Ç–æ–º
4. –£–¥–∞–ª–∏—Ç–µ —á–∞—Ç (–µ—Å–ª–∏ –≤—ã ADMIN)
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω–≤–∞–π—Ç—ã

## üöÄ –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É

- ‚úÖ –ü–æ–ª–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª Telegram
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω
- ‚úÖ Touch –∏ mouse –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- ‚úÖ Error handling
- ‚úÖ Loading states
